generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model City {
  id                 String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name               String
  description        String        @default("")
  imageUrl           String        @default("") @map("image_url")
  createdAt          DateTime      @default(now()) @map("created_at") @db.Timestamptz(6)
  departureRoutes    FlightRoute[] @relation("DepartureCity")
  arrivalRoutes      FlightRoute[] @relation("ArrivalCity")

  @@map("cities")
}

model Payment {
  id             String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  flightRouteId  String      @map("flight_route_id") @db.Uuid
  userId         String?     @map("user_id") @db.Uuid
  userEmail      String      @map("user_email")
  userName       String      @map("user_name")
  status         String      @default("pending")
  amount         Decimal     @default(0) @db.Decimal(15, 2)
  paymentProof   String?     @map("payment_proof")
  createdAt      DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime    @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  flightRoute    FlightRoute @relation(fields: [flightRouteId], references: [id], onDelete: Cascade)

  @@map("payments")
}

model User {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email       String   @unique
  name        String?
  username    String?
  phoneNumber String?  @map("phone_number")
  ssoUserId   Int?     @map("sso_user_id")
  lastLogin   DateTime? @map("last_login") @db.Timestamptz(6)
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("users")
}

model Admin {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("admins")
}


model CustomerReview {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  customerName String  @map("customer_name")
  rating      Int      @default(5)
  comment     String
  imageUrl    String?  @map("image_url")
  location    String?
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("customer_reviews")
}


model SiteSettings {
  id                   String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  logoUrl              String   @default("/logo.png") @map("logo_url")
  siteName             String   @default("Travel Indonesia") @map("site_name")
  metaTitle            String   @default("Travel Indonesia - Jelajahi Dunia Bersama Kami") @map("meta_title")
  metaDescription      String   @default("Temukan penawaran terbaik untuk penerbangan, hotel, dan paket liburan") @map("meta_description")
  heroTitle            String   @default("JELAJAHI DUNIA BERSAMA KAMI") @map("hero_title")
  heroSubtitle         String   @default("Temukan penawaran terbaik untuk penerbangan, hotel, dan paket liburan") @map("hero_subtitle")
  heroImageUrl         String   @default("https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1") @map("hero_image_url")
  flightHeroTitle      String   @default("Make your travel wishlist, we'll do the rest") @map("flight_hero_title")
  flightHeroSubtitle   String   @default("Special offers to suit your plan") @map("flight_hero_subtitle")
  flightHeroImageUrl   String   @default("https://images.unsplash.com/photo-1542296332-2e4473faf563") @map("flight_hero_image_url")
  whatsappNumber       String   @default("") @map("whatsapp_number")
  createdAt            DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt            DateTime @default(now()) @map("updated_at") @db.Timestamptz(6)

  @@map("site_settings")
}

model BankAccount {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  bankName      String   @map("bank_name")
  accountNumber String   @map("account_number")
  accountName   String   @map("account_name")
  isActive      Boolean  @default(true) @map("is_active")
  displayOrder  Int      @default(0) @map("display_order")
  createdAt     DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("bank_accounts")
}


model FlightRoute {
  id                     String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  departureCityId        String                  @map("departure_city_id") @db.Uuid
  arrivalCityId          String                  @map("arrival_city_id") @db.Uuid
  departureDate          DateTime                @map("departure_date") @db.Date
  returnDate             DateTime?               @map("return_date") @db.Date
  airline                String
  departureTime          DateTime                @map("departure_time") @db.Time
  arrivalTime            DateTime                @map("arrival_time") @db.Time
  duration               String
  rating                 Int                     @default(0)
  availableSeats         Int                     @default(0) @map("available_seats")
  flightClass            String                  @default("economy") @map("flight_class")
  baggageInfo            String?                 @map("baggage_info")
  imageUrl               String                  @default("") @map("image_url")
  description            String                  @default("")
  baseFare               Decimal                 @default(0) @map("base_fare") @db.Decimal(15, 2)
  tax                    Decimal                 @default(0) @db.Decimal(15, 2)
  serviceFee             Decimal                 @default(0) @map("service_fee") @db.Decimal(15, 2)
  baggageFee             Decimal                 @default(0) @map("baggage_fee") @db.Decimal(15, 2)
  wifiFee                Decimal                 @default(0) @map("wifi_fee") @db.Decimal(15, 2)
  mealFee                Decimal                 @default(0) @map("meal_fee") @db.Decimal(15, 2)
  insuranceFee           Decimal                 @default(0) @map("insurance_fee") @db.Decimal(15, 2)
  otherFees              Json                    @default("[]") @map("other_fees") @db.JsonB
  discount               Decimal                 @default(0) @db.Decimal(15, 2)
  totalPrice             Decimal                 @default(0) @map("total_price") @db.Decimal(15, 2)
  createdAt              DateTime                @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt              DateTime                @default(now()) @map("updated_at") @db.Timestamptz(6)
  departureCity          City                    @relation("DepartureCity", fields: [departureCityId], references: [id], onDelete: Cascade)
  arrivalCity            City                    @relation("ArrivalCity", fields: [arrivalCityId], references: [id], onDelete: Cascade)
  payments               Payment[]
  popularFlightRoute     PopularFlightRoute?

  @@map("flight_routes")
}

model PopularFlightRoute {
  id             String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  flightRouteId  String      @unique @map("flight_route_id") @db.Uuid
  displayOrder   Int         @default(0) @map("display_order")
  isActive       Boolean     @default(true) @map("is_active")
  imageUrl       String?     @map("image_url")
  createdAt      DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime    @default(now()) @map("updated_at") @db.Timestamptz(6)
  flightRoute    FlightRoute @relation(fields: [flightRouteId], references: [id], onDelete: Cascade)

  @@map("popular_flight_routes")
}
